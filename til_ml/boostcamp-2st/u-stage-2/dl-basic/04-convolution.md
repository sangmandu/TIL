---
description: '210811'
---

# \(04강\) Convolution은 무엇인가?

## Convolution

![](../../../../.gitbook/assets/image%20%28834%29.png)

I는 입력 이미지, K는 적용하고자 하는 커널이다.

![](../../../../.gitbook/assets/image%20%28835%29.png)

3x3 필터와 7x7 이미지를 컨볼루션 연산을 하면 5x5가 나온다.

![](../../../../.gitbook/assets/image%20%28825%29.png)

같은 이미지에 대해서 적용하고자 하는 필터의 모양에 따라서 Output이 흐려지거나 강조될 수 있고 외곽선만 딸 수도 있다.

![](../../../../.gitbook/assets/image%20%28833%29.png)

일반적으로 이미지에 대해 5x5 필터를 사용한다는 것은 이미지의 채널 개수와 필터의 커널의 개수가 동일하다는 조건이 있기 때문에 문제될 것이 없다. 이미지가 32x32x3 이라면 5x5필터도 5x5x3이 될것이다.

![](../../../../.gitbook/assets/image%20%28822%29.png)

또, 여러개의 필터를 쓸 수도 있고 여러 층에서 이어서 사용할 수도 있다

이 때, 파라미터의 수를 구하는 것이 중요하다. \(우측 그림을 보면\)

* 첫번째 층에서의 파라미터 수는 커널의 크기 5x5 그리고 채널 수 3 그리고 output의 채널 수 4를 곱한 5x5x3x4 가 된다.
* 두번째 층에서의 파라미터 수는 커널의 크기 5x5 그리고 채널 수 4 그리고 output의 채널 수 10을 곱한 5x5x4x10이 된다

![](../../../../.gitbook/assets/image%20%28826%29.png)

Convolution Neural Network, CNN은 도장을 찍는 Conv와 Pooling 그리고 Fully Connected, FC로 이루어져 있다.

* 최근에 추세는 FC를 제거하는 방향이다. 왜냐하면 FC는 모델의 파라미터 수를 많이 필요하기 때문이다.
  * 파라미터 수가 많아지면 학습이 어려워지고 범용성이 줄어들게된다.

#### Stride

![](../../../../.gitbook/assets/image%20%28836%29.png)

S = 1이면 픽셀을 한칸씩 이동하고 S = 2이면 픽셀을 두칸씩 이동한다

#### Padding

![](../../../../.gitbook/assets/image%20%28824%29.png)

커널은 가장자리를 중심으로 찍지 못하는데, 패딩을 덧대면 가능하다.

![](../../../../.gitbook/assets/1%20%281%29.gif)

![](../../../../.gitbook/assets/image%20%28827%29.png)

파라미터의 개수는 커널의 크기 \* 인풋 채널 수 \* 아웃풋 채널 수 이다. 이걸 알아야 하는 이유는 어떤 모델을 볼 때 그 모델의 파라미터의 수가 대략 만단위 인지 십만단위 인지를 바로 파악해야 하기 때문이다.

![](../../../../.gitbook/assets/image%20%28823%29.png)

첫번째 레이어

* 필터의 크기 : 11x11
* 입력채널 : 3
* 출력채널 : 96
  * 이 때는 GPU 메모리가 부족해서 48개의 채널을 2개의 Stream으로 나누어서 진행했다.
* 파라미터 수 : 11 \* 11 \* 3 \* 48 \* 2 = 35k

두번째 레이어

* 필터의 크기 : 5x5
* 입력채널 : 48
* 출력 채널 : 128 \* 2
* 파라미터 수 : 307k

세번째 레이어 : \(3x3, 12



